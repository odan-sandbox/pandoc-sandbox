この記事は、 [OIT Advent Calendar 2017の3日目の記事](https://adventar.org/calendars/2102)です。

以前からブログは持っていたのですが、[ブログを丸ごとHaskellで生成していた](https://eliza.link/#/posts/create-blog-hakyll.html)ため環境がかわるたびにブログを生成するためのソフトウェア(静的ブログジェネレータ)をビルドしなければなりませんでした、が、できない。どうしても依存しているライブラリのビルドに失敗する(おそらくpandocが悪そう)、ということがしょっちゅうあったので、ブログを作り直しました。

ブログのビルドがめんどさいなら、読者にビルドしてもらえばいいじゃん？という発想のもと、markdownを書いて公開するだけであとはルーティングから原稿の取得、記事の生成まで全て読者のブラウザがやってくれるようにつくりました。ごめんね！

## 使った技術

使ってみたかったもの・技術を複数導入してみました。いきなり本番運用です。

### Materialize CSS

今回はデザインで悩みたくなかった、かつスマホ対応で悩みたくなかったので[Materialize CSS](http://materializecss.com/)を利用してブログをデザインしました。

が

スマホ対応出来て無い気がするんですか？？？？？？？？

しかもほとんど全ての要素が`!important`で固定されていて上書き出来無いのでスマホ対応その他がとてもめんどくさい…

デザインは納得の行くものが簡単に作れて非常によかった。ドキュメントも非常に整備されていて基本的にそこを参照すれば全て解決します。おすすめです。

### Vue.js

[dev.to](https://dev.to)に影響されて、ブログを[vue.js](https://jp.vuejs.org/index.html)でSPA風にしています。現在は記事の取得に時間がかかるせいであまり速いサイトに見えないのですが、気が向いたら先読みを実装して高速化しようと思います。

<!-- ![screen_record](create-blog-vuejs/blog-sample.png) -->

Vue.jsの仮想DOMを利用して、画面全体を再線画しないことにより、リクエストが発生しないページ、例えばタグ一覧のページ遷移は非常に高速になっています。

Vue.jsはドキュメントがかなり整理されている上に翻訳もきちんとされているので、基本公式ドキュメントを読むだけで困ることはありませんでした。

### Github pages

これは以前から利用していたのですが、今回も利用させていただきました。適当なサーバースペースよりかなり使い勝手がいいので気に入っています。

### Croudflare

無料でも利用できるDNSです、なんだか色々機能はあるみたいなのですが、私は `HTHS` ぐらいしか使っていません。あと `eliza.link` ドメインを利用するのに使っています。

### Javascript

この流れでJS？？？？？と思うかもしれませんが私は物を作るのにJSを使ったことがなかったので今回はじめて利用しました。沢山地雷を踏み抜いてつらかった…

#### 踏みぬいた地雷: this

```javascript
var vm = new Vue({
  ...
  computed: {
    foo: function () {
      return bar(() => {
         // thisはvmを指してほしいが、barを指し示す
         return this.value
      })
    }
  }
})
```

これが本当に辛かった…

#### 踏みぬいた地雷: JSON.parse()

```javascript
var json = // HTTP GET http://example.com/foo.json
JSON.parse(json) // ERROR!!!
```

これもわけが分からなくて滅茶滅茶苦労しました。結果として

```javascript
var json = // HTTP GET http://example.com/foo.json
JSON.parse(JSON.stringify(json)) // SUCCESS!!!
```

で解決しました。つらい…

#### 踏みぬいた地雷: 勝手にスクロールしてしまう

DOMを書き換えると勝手にスクロールしてしまう現象が多発した

```html
<ul>
  <!-- ここに検索にヒットした記事がついかされていく -->
</ul>
```

対策として、これを

```html
<ul id="foo">
  <!-- ここに検索にヒットした記事がついかされていく -->
</ul>
```

に変更することで解決しました。ページの内容を書き換える際にブラウザが目印にするidが必要だからだそうです。

## 感想

ドキュメントが整備されているライブラリは神

## おわりに

OIT Advent calenderを書くためにブログを作った話を書いたのでAdvent calenderで書くつもりだった記事を書けませんでした、ざんねんですね(？)

私は本日[kosen14s Advent Calender 2017](https://adventar.org/calendars/2388)で『[自作CPUを作ったので自慢する](/#/posts/create-cpu.html)』もかいているので、もしよかったらそっちも読んでくれるとうれしいです。

明日はEutrema氏による『技術的なことをブログを書いたほうがいい理由』です、楽しみですね。

